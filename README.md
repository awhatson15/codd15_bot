# ЦОДД Электронная очередь - Telegram Bot

Telegram-бот для отслеживания очереди автомобилей на странице https://codd15.ru/ticket.html. Бот автоматически отправляет уведомления пользователям при изменении статуса их автомобиля в электронной очереди.

## Функционал

- Отслеживание номера автомобиля в очереди ЦОДД
- Проверка позиции в очереди по запросу
- Гибкие настройки уведомлений:
  - Интервальный режим (периодические уведомления)
  - Уведомления при изменении позиции
  - Уведомления при сдвиге очереди на N позиций
- Возможность включать несколько режимов уведомлений одновременно
- Поддержка многих пользователей

## Технологии

- Python 3.10
- aiogram (Telegram Bot API фреймворк)
- SQLite3 (хранение данных)
- BeautifulSoup4 (парсинг HTML)
- Docker & Docker Compose (контейнеризация)
- apscheduler (планировщик задач)

## Структура проекта

```
.
├── bot/                      # Основной код бота
│   ├── config/               # Конфигурация
│   ├── handlers/             # Обработчики сообщений
│   ├── keyboards/            # Клавиатуры и кнопки
│   ├── models/               # Модели данных и работа с БД
│   ├── services/             # Сервисы (парсер и уведомления)
│   └── utils/                # Вспомогательные утилиты
├── database/                 # Директория с файлами БД
├── .env                      # Переменные окружения
├── .env.example              # Пример конфигурации
├── docker-compose.yml        # Конфигурация Docker Compose
├── Dockerfile                # Dockerfile для сборки образа
└── requirements.txt          # Зависимости Python
```

## Установка и запуск

### Настройка переменных окружения

Скопируйте файл `.env.example` в `.env` и заполните необходимые параметры:

```bash
cp .env.example .env
```

Отредактируйте файл `.env`, указав токен вашего Telegram-бота.

### Запуск с использованием Docker Compose

```bash
docker-compose up -d
```

### Запуск без Docker

1. Создайте виртуальное окружение и установите зависимости:

```bash
python -m venv venv
source venv/bin/activate  # для Linux/Mac
venv\Scripts\activate     # для Windows
pip install -r requirements.txt
```

2. Запустите бота:

```bash
python -m bot
```

3. Запустите парсер в отдельном терминале:

```bash
python -m bot.services.parser
```

## Использование

1. Начните диалог с ботом, отправив команду `/start`
2. Введите номер вашего автомобиля в формате `P131XM61-AP234015`
3. Настройте уведомления по вашему усмотрению
4. Получайте автоматические уведомления об изменениях в очереди

## Команды бота

- `/start` - Начать диалог и ввести/изменить номер автомобиля
- `/check` - Проверить текущую позицию в очереди
- `/settings` - Настройки уведомлений
- `/help` - Справка по использованию бота 